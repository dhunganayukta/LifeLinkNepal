{% extends 'base.html' %}
{% load static %}

{% block title %}Blood Request Detail — LifeLink Nepal{% endblock %}

{% block extra_css %}
<style>
.dash-wrap { background: var(--ivory); min-height: 100vh; padding: 48px 0 80px; }

/* HERO */
.dash-hero { background: var(--ink); border-radius: 16px; padding: 36px 40px; margin-bottom: 40px; position: relative; overflow: hidden; }
.dash-hero::before { content:''; position:absolute; top:-80px; right:-80px; width:280px; height:280px; border-radius:50%; border:1px solid rgba(196,146,74,0.12); pointer-events:none; }
.dash-hero::after  { content:''; position:absolute; top:-40px; right:-40px; width:180px; height:180px; border-radius:50%; border:1px solid rgba(196,146,74,0.07); pointer-events:none; }
.dash-hero-crimson-bar { position:absolute; top:0; left:0; width:4px; height:100%; background:linear-gradient(180deg, var(--crimson) 0%, var(--gold) 100%); border-radius:4px 0 0 4px; }
.dash-hero-eyebrow { display:inline-flex; align-items:center; gap:8px; margin-bottom:10px; }
.dash-hero-eyebrow span { font-size:10.5px; letter-spacing:3px; text-transform:uppercase; font-weight:600; color:var(--gold); }
.dash-hero-eyebrow-line { width:20px; height:1px; background:var(--gold); opacity:0.6; }
.dash-hero h2 { font-family:var(--font-display); font-size:clamp(28px,3.5vw,44px); font-weight:600; color:white; letter-spacing:-0.3px; line-height:1.15; margin-bottom:8px; }
.dash-hero p { font-size:14.5px; color:rgba(240,232,222,0.6); margin:0; display:flex; align-items:center; gap:6px; }
.btn-dash-secondary { display:inline-flex; align-items:center; gap:8px; padding:9px 20px; background:transparent; color:rgba(240,232,222,0.75); font-size:13px; font-weight:600; border-radius:8px; text-decoration:none; transition:all 0.25s ease; border:1.5px solid rgba(240,232,222,0.2); }
.btn-dash-secondary:hover { border-color:rgba(196,146,74,0.5); color:var(--gold-light); background:rgba(196,146,74,0.08); }

/* CARDS */
.dash-card { background:white; border:1px solid var(--border-subtle); border-radius:14px; overflow:hidden; margin-bottom:24px; }
body.dark-mode .dash-card { background:#1a1410; border-color:rgba(255,255,255,0.06); }
.dash-card-header { padding:20px 24px; border-bottom:1px solid var(--border-subtle); display:flex; align-items:center; justify-content:space-between; background:var(--ivory-mid); }
body.dark-mode .dash-card-header { background:#221c17; border-color:rgba(255,255,255,0.05); }
.dash-card-title { font-family:var(--font-display); font-size:19px; font-weight:600; color:var(--ink); display:flex; align-items:center; gap:10px; }
.dash-card-title i { color:var(--crimson); font-size:16px; }
.dash-card-body { padding:24px; }

/* URGENCY BANNER */
.urgency-banner { padding:18px 22px; border-radius:12px; display:flex; align-items:center; gap:14px; margin-bottom:24px; }
.urgency-banner.critical { background:rgba(155,23,40,0.08); border:1px solid rgba(155,23,40,0.25); }
.urgency-banner.urgent   { background:rgba(196,146,74,0.08); border:1px solid rgba(196,146,74,0.25); }
.urgency-banner.normal   { background:rgba(59,130,246,0.06); border:1px solid rgba(59,130,246,0.2); }
.urgency-icon { width:46px; height:46px; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:20px; flex-shrink:0; animation:pulse-icon 2s infinite; }
@keyframes pulse-icon { 0%,100%{opacity:1;} 50%{opacity:0.7;} }
.urgency-banner.critical .urgency-icon { background:rgba(155,23,40,0.12); color:var(--crimson); }
.urgency-banner.urgent   .urgency-icon { background:var(--gold-pale); color:var(--gold); }
.urgency-banner.normal   .urgency-icon { background:rgba(59,130,246,0.1); color:#2563eb; }
.urgency-title { font-family:var(--font-display); font-size:16px; font-weight:600; color:var(--ink); margin-bottom:2px; }
.urgency-sub   { font-size:12.5px; color:var(--ink-muted); }

/* BLOOD DISPLAY */
.blood-display { width:110px; height:110px; border-radius:50%; background:var(--crimson); display:flex; align-items:center; justify-content:center; font-family:var(--font-display); font-size:30px; font-weight:700; color:white; margin:0 auto 12px; box-shadow:0 8px 24px rgba(155,23,40,0.35); position:relative; }
.blood-display::before { content:''; position:absolute; inset:-8px; border-radius:50%; background:var(--crimson); opacity:0.12; animation:pulse-ring 2.5s infinite; }
@keyframes pulse-ring { 0%,100%{transform:scale(1);opacity:0.12;} 50%{transform:scale(1.1);opacity:0;} }

/* STAT BLOCKS */
.stat-block { background:var(--ivory-mid); border:1px solid var(--border-subtle); border-radius:10px; padding:14px; text-align:center; }
body.dark-mode .stat-block { background:#221c17; }
.stat-block-label { font-size:10.5px; letter-spacing:1.5px; text-transform:uppercase; font-weight:600; color:var(--ink-muted); margin-bottom:5px; }
.stat-block-value { font-family:var(--font-display); font-size:18px; font-weight:700; color:var(--ink); line-height:1; }

/* TAGS */
.tag { display:inline-flex; align-items:center; gap:4px; padding:3px 10px; border-radius:20px; font-size:11.5px; font-weight:700; letter-spacing:0.3px; }
.tag-crimson { background:var(--crimson-pale); color:var(--crimson); border:1px solid var(--border); }
.tag-gold    { background:var(--gold-pale);    color:var(--gold);    border:1px solid rgba(196,146,74,0.25); }
.tag-green   { background:rgba(74,222,128,0.1); color:#16a34a;       border:1px solid rgba(74,222,128,0.2); }
.tag-blue    { background:rgba(59,130,246,0.1); color:#2563eb;       border:1px solid rgba(59,130,246,0.2); }
.tag-ink     { background:rgba(28,20,16,0.06); color:var(--ink-mid); border:1px solid var(--border-subtle); }

/* INFO ROWS */
.info-row { display:flex; justify-content:space-between; align-items:center; padding:12px 0; border-bottom:1px solid var(--border-subtle); font-size:13.5px; }
.info-row:last-child { border-bottom:none; padding-bottom:0; }
.info-row:first-child { padding-top:0; }
.info-label { color:var(--ink-muted); font-weight:500; display:flex; align-items:center; gap:6px; }
.info-label i { color:var(--crimson); font-size:13px; }
.info-value { font-weight:600; color:var(--ink); text-align:right; }

/* ELIGIBILITY */
.eligibility-box { border-radius:12px; padding:18px 20px; display:flex; align-items:center; gap:14px; margin-bottom:16px; }
.eligibility-box.eligible   { background:rgba(74,222,128,0.08); border:1px solid rgba(74,222,128,0.25); }
.eligibility-box.ineligible { background:var(--crimson-pale); border:1px solid rgba(155,23,40,0.2); }
.eligibility-icon { width:44px; height:44px; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:20px; flex-shrink:0; }
.eligibility-box.eligible   .eligibility-icon { background:rgba(74,222,128,0.15); color:#16a34a; }
.eligibility-box.ineligible .eligibility-icon { background:rgba(155,23,40,0.12); color:var(--crimson); }
.eligibility-title { font-size:14px; font-weight:700; color:var(--ink); margin-bottom:2px; }
.eligibility-sub   { font-size:12px; color:var(--ink-muted); }

/* NOTICE BAR */
.notice-bar { border-radius:10px; padding:14px 18px; font-size:13px; display:flex; align-items:flex-start; gap:10px; margin-bottom:16px; }
.notice-bar.info    { background:rgba(59,130,246,0.06); border:1px solid rgba(59,130,246,0.2);  color:var(--ink-mid); }
.notice-bar.warning { background:rgba(196,146,74,0.08); border:1px solid rgba(196,146,74,0.25); color:var(--ink-mid); }
.notice-bar i { margin-top:1px; flex-shrink:0; }
.notice-bar.info    i { color:#2563eb; }
.notice-bar.warning i { color:var(--gold); }

/* BUTTONS */
.btn-accept { display:flex; align-items:center; justify-content:center; gap:8px; padding:14px 20px; background:#16a34a; color:white; font-size:14px; font-weight:700; border-radius:8px; border:1.5px solid #16a34a; cursor:pointer; transition:all 0.25s ease; width:100%; }
.btn-accept:hover { background:#15803d; border-color:#15803d; transform:translateY(-2px); box-shadow:0 6px 18px rgba(22,163,74,0.35); color:white; }
.btn-decline { display:flex; align-items:center; justify-content:center; gap:8px; padding:14px 20px; background:var(--crimson-pale); color:var(--crimson); font-size:14px; font-weight:700; border-radius:8px; border:1.5px solid rgba(155,23,40,0.3); cursor:pointer; transition:all 0.25s ease; width:100%; }
.btn-decline:hover { background:var(--crimson); color:white; border-color:var(--crimson); transform:translateY(-2px); box-shadow:0 6px 18px rgba(155,23,40,0.35); }
.btn-phone { display:flex; align-items:center; justify-content:center; gap:8px; padding:10px 18px; background:var(--crimson); color:white; font-size:13px; font-weight:700; border-radius:8px; text-decoration:none; transition:all 0.25s ease; border:1.5px solid var(--crimson); width:100%; }
.btn-phone:hover { background:var(--crimson-mid); color:white; transform:translateY(-1px); }

/* MODAL */
.modal-content { border-radius:14px; border:1px solid var(--border-subtle); }
.modal-header-styled { padding:20px 24px; border-bottom:1px solid var(--border-subtle); display:flex; align-items:center; justify-content:space-between; border-radius:14px 14px 0 0; }
.modal-header-styled.green   { background:rgba(74,222,128,0.08); }
.modal-header-styled.crimson { background:var(--crimson-pale); }
.modal-title-styled { font-family:var(--font-display); font-size:19px; font-weight:600; color:var(--ink); display:flex; align-items:center; gap:8px; }
.form-label-styled { display:block; font-size:12px; letter-spacing:1.5px; text-transform:uppercase; font-weight:700; color:var(--ink-muted); margin-bottom:8px; }
.form-control-styled { width:100%; padding:11px 14px; background:var(--ivory-mid); border:1.5px solid var(--border-subtle); border-radius:8px; font-size:13.5px; color:var(--ink); outline:none; transition:all 0.2s ease; font-family:inherit; }
.form-control-styled:focus { border-color:var(--crimson); background:white; box-shadow:0 0 0 3px rgba(155,23,40,0.08); }
.select-wrap { position:relative; }
.select-wrap::after { content:'\F282'; font-family:'Bootstrap-icons'; position:absolute; right:12px; top:50%; transform:translateY(-50%); color:var(--ink-muted); pointer-events:none; font-size:13px; }
.select-wrap select.form-control-styled { padding-right:34px; appearance:none; cursor:pointer; }
.btn-modal-confirm { display:inline-flex; align-items:center; gap:8px; padding:10px 22px; background:#16a34a; color:white; font-size:13.5px; font-weight:700; border-radius:8px; border:none; cursor:pointer; transition:all 0.2s ease; }
.btn-modal-danger  { display:inline-flex; align-items:center; gap:8px; padding:10px 22px; background:var(--crimson); color:white; font-size:13.5px; font-weight:700; border-radius:8px; border:none; cursor:pointer; transition:all 0.2s ease; }
.btn-modal-cancel  { display:inline-flex; align-items:center; gap:8px; padding:10px 20px; background:transparent; color:var(--ink-mid); font-size:13.5px; font-weight:600; border-radius:8px; border:1.5px solid var(--border-subtle); cursor:pointer; transition:all 0.2s ease; }

body.dark-mode .dash-wrap { background:var(--ivory); }
</style>
{% endblock %}

{% block content %}
<div class="dash-wrap">
<div class="container">

    <!-- HERO -->
    <div class="dash-hero">
        <div class="dash-hero-crimson-bar"></div>
        <div class="row align-items-center g-4">
            <div class="col-lg-8">
                <div class="dash-hero-eyebrow">
                    <div class="dash-hero-eyebrow-line"></div>
                    <span>Blood Request</span>
                    <div class="dash-hero-eyebrow-line"></div>
                </div>
                <h2>Blood Request Details</h2>
                <p><i class="bi bi-calendar3"></i> Posted: {{ blood_request.date_requested|date:"F j, Y — g:i A" }}</p>
            </div>
            <div class="col-lg-4 d-flex justify-content-lg-end">
                <a href="{% url 'donor_dashboard' %}" class="btn-dash-secondary">
                    <i class="bi bi-arrow-left"></i> Back
                </a>
            </div>
        </div>
    </div>

    <div class="row g-4">

        <!-- LEFT: Details -->
        <div class="col-lg-8">

            <!-- Urgency Banner -->
            <div class="urgency-banner {% if blood_request.urgency_level == 'critical' %}critical{% elif blood_request.urgency_level == 'urgent' %}urgent{% else %}normal{% endif %}">
                <div class="urgency-icon"><i class="bi bi-exclamation-triangle-fill"></i></div>
                <div class="flex-grow-1">
                    <div class="urgency-title">
                        {% if blood_request.urgency_level == 'critical' %}CRITICAL — Immediate Blood Needed!
                        {% elif blood_request.urgency_level == 'urgent' %}URGENT — Blood Needed Soon
                        {% else %}Blood Request Active{% endif %}
                    </div>
                    <div class="urgency-sub">This patient urgently needs your help.</div>
                </div>
                <span class="tag {% if blood_request.urgency_level == 'critical' %}tag-crimson{% elif blood_request.urgency_level == 'urgent' %}tag-gold{% else %}tag-blue{% endif %}">
                    {{ blood_request.urgency_level|upper }}
                </span>
            </div>

            <!-- Blood Type + Patient -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <div class="dash-card-title"><i class="bi bi-droplet-fill"></i> Patient Information</div>
                </div>
                <div class="dash-card-body">
                    <div class="text-center mb-4">
                        <div class="blood-display">{{ blood_request.blood_type }}</div>
                        <div style="font-size:12px; color:var(--ink-muted);">Blood Type Required</div>
                        <div style="font-size:13px; color:var(--ink-mid); margin-top:6px;">
                            Your blood type: <strong style="color:var(--crimson);">{{ donor_blood_type }}</strong>
                            {% if donor_blood_type == blood_request.blood_type %}
                                <span class="tag tag-green" style="margin-left:6px;"><i class="bi bi-check-circle-fill"></i> Exact Match</span>
                            {% else %}
                                <span class="tag tag-blue" style="margin-left:6px;"><i class="bi bi-check-circle"></i> Compatible</span>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row g-3">
                        <div class="col-6 col-md-3"><div class="stat-block"><div class="stat-block-label">Patient</div><div class="stat-block-value" style="font-size:13px;">{{ blood_request.patient_name }}</div></div></div>
                        <div class="col-6 col-md-3"><div class="stat-block"><div class="stat-block-label">Age</div><div class="stat-block-value">{{ blood_request.patient_age }} yrs</div></div></div>
                        <div class="col-6 col-md-3"><div class="stat-block"><div class="stat-block-label">Units</div><div class="stat-block-value">{{ blood_request.units_required }}</div></div></div>
                        <div class="col-6 col-md-3"><div class="stat-block"><div class="stat-block-label">Required By</div><div class="stat-block-value" style="font-size:12px;">{{ blood_request.required_by|date:"M d, Y" }}</div></div></div>
                    </div>
                    {% if blood_request.reason %}
                    <div style="background:var(--ivory-mid); border:1px solid var(--border-subtle); border-radius:8px; padding:14px; margin-top:16px; font-size:13px; color:var(--ink-muted);">
                        <i class="bi bi-file-text-fill me-2" style="color:var(--gold);"></i>{{ blood_request.reason }}
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Hospital Info -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <div class="dash-card-title"><i class="bi bi-hospital-fill"></i> Hospital Information</div>
                </div>
                <div class="dash-card-body" style="padding-top:8px; padding-bottom:8px;">
                    <div class="info-row"><span class="info-label"><i class="bi bi-building"></i> Hospital</span><span class="info-value">{{ hospital.hospital_name }}</span></div>
                    <div class="info-row"><span class="info-label"><i class="bi bi-geo-alt-fill"></i> Address</span><span class="info-value">{{ hospital.address }}</span></div>
                    <div class="info-row"><span class="info-label"><i class="bi bi-telephone-fill"></i> Phone</span><span class="info-value"><a href="tel:{{ hospital.phone }}" style="color:var(--crimson); text-decoration:none; font-weight:700;">{{ hospital.phone }}</a></span></div>
                    {% if hospital.email %}
                    <div class="info-row"><span class="info-label"><i class="bi bi-envelope-fill"></i> Email</span><span class="info-value"><a href="mailto:{{ hospital.email }}" style="color:var(--ink); text-decoration:none;">{{ hospital.email }}</a></span></div>
                    {% endif %}
                    {% if distance %}
                    <div class="info-row"><span class="info-label"><i class="bi bi-pin-map-fill"></i> Distance</span><span class="info-value"><span class="tag tag-blue"><i class="bi bi-geo-alt"></i> {{ distance }} km</span></span></div>
                    {% endif %}
                </div>
            </div>

            <!-- Action Buttons -->
            {% if is_eligible and blood_request.status == 'pending' %}
            <div class="dash-card">
                <div class="dash-card-header">
                    <div class="dash-card-title"><i class="bi bi-hand-thumbs-up"></i> Ready to Save a Life?</div>
                </div>
                <div class="dash-card-body">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <button type="button" class="btn-accept" data-bs-toggle="modal" data-bs-target="#acceptModal">
                                <i class="bi bi-check-circle-fill"></i> Accept Request
                            </button>
                        </div>
                        <div class="col-md-6">
                            <button type="button" class="btn-decline" data-bs-toggle="modal" data-bs-target="#declineModal">
                                <i class="bi bi-x-circle-fill"></i> Decline Request
                            </button>
                        </div>
                    </div>
                    <div style="text-align:center; margin-top:12px; font-size:12px; color:var(--ink-muted);">
                        <i class="bi bi-shield-check me-1" style="color:#16a34a;"></i>
                        Your contact info will be shared with the hospital upon acceptance
                    </div>
                </div>
            </div>
            {% elif not is_eligible %}
            <div class="notice-bar warning">
                <i class="bi bi-exclamation-triangle-fill"></i>
                <div><strong style="color:var(--ink);">Not eligible at this time.</strong> Please check back later or explore other requests.</div>
            </div>
            {% else %}
            <div class="notice-bar info">
                <i class="bi bi-info-circle-fill"></i>
                <div><strong style="color:var(--ink);">This request is no longer active.</strong></div>
            </div>
            {% endif %}

        </div>

        <!-- RIGHT: Sidebar -->
        <div class="col-lg-4">

            <!-- Eligibility -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <div class="dash-card-title"><i class="bi bi-check-shield"></i> Your Eligibility</div>
                </div>
                <div class="dash-card-body">
                    {% if is_eligible %}
                    <div class="eligibility-box eligible">
                        <div class="eligibility-icon"><i class="bi bi-check-circle-fill"></i></div>
                        <div><div class="eligibility-title">You're Eligible!</div><div class="eligibility-sub">You meet all requirements to donate</div></div>
                    </div>
                    <p style="font-size:12px; color:var(--ink-muted); margin:0;">
                        <i class="bi bi-info-circle me-1" style="color:#2563eb;"></i>
                        You meet all requirements to donate for this request.
                    </p>
                    {% else %}
                    <div class="eligibility-box ineligible">
                        <div class="eligibility-icon"><i class="bi bi-x-circle-fill"></i></div>
                        <div><div class="eligibility-title">Not Eligible</div><div class="eligibility-sub">{% if not can_donate %}Wait period required{% else %}Criteria not met{% endif %}</div></div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Request Stats -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <div class="dash-card-title"><i class="bi bi-graph-up"></i> Request Stats</div>
                </div>
                <div class="dash-card-body" style="padding-top:8px; padding-bottom:8px;">
                    <div class="info-row"><span class="info-label"><i class="bi bi-clock"></i> Posted</span><span class="info-value" style="font-size:12.5px;">{{ blood_request.date_requested|timesince }} ago</span></div>
                    <div class="info-row">
                        <span class="info-label"><i class="bi bi-activity"></i> Status</span>
                        {% if blood_request.status == 'pending' %}<span class="tag tag-gold">Pending</span>
                        {% elif blood_request.status == 'fulfilled' %}<span class="tag tag-green">Fulfilled</span>
                        {% else %}<span class="tag tag-ink">{{ blood_request.status|title }}</span>{% endif %}
                    </div>
                    {% if priority_score %}
                    <div class="info-row"><span class="info-label"><i class="bi bi-star-fill"></i> Priority</span><span class="info-value" style="color:var(--crimson);">{{ priority_score }}</span></div>
                    {% endif %}
                </div>
            </div>

            <!-- Emergency Contact -->
            <div class="dash-card">
                <div class="dash-card-header">
                    <div class="dash-card-title"><i class="bi bi-telephone-fill"></i> Emergency</div>
                </div>
                <div class="dash-card-body">
                    <p style="font-size:13px; color:var(--ink-muted); margin-bottom:12px;">Call hospital directly for urgent coordination:</p>
                    <a href="tel:{{ hospital.phone }}" class="btn-phone"><i class="bi bi-telephone-fill"></i> {{ hospital.phone }}</a>
                </div>
            </div>

        </div>
    </div>

</div>
</div>

<!-- ACCEPT MODAL -->
<div class="modal fade" id="acceptModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header-styled green">
                <div class="modal-title-styled"><i class="bi bi-check-circle-fill" style="color:#16a34a;"></i> Confirm Acceptance</div>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="POST" action="{% url 'accept_blood_request' blood_request.id %}">
                {% csrf_token %}
                <div style="padding:24px;">
                    <div style="background:rgba(74,222,128,0.08); border:1px solid rgba(74,222,128,0.25); border-radius:10px; padding:14px; margin-bottom:16px; font-size:13.5px; color:var(--ink-mid); display:flex; align-items:center; gap:8px;">
                        <i class="bi bi-heart-fill" style="color:#16a34a;"></i>
                        <strong style="color:var(--ink);">Thank you for being a hero!</strong>
                    </div>
                    <p style="font-size:13.5px; color:var(--ink-mid); margin-bottom:10px;">By accepting, you confirm that:</p>
                    <ul style="font-size:13px; color:var(--ink-muted); padding-left:20px; margin-bottom:16px;">
                        <li>You are available to donate blood for this patient</li>
                        <li>Your details will be shared with {{ hospital.hospital_name }}</li>
                        <li>You will coordinate directly with the hospital</li>
                        <li>You meet all health requirements for blood donation</li>
                    </ul>
                    <label class="form-label-styled">Additional Notes (Optional)</label>
                    <textarea class="form-control-styled" name="notes" rows="3" placeholder="Any special notes or preferred contact time..."></textarea>
                </div>
                <div style="padding:16px 24px; border-top:1px solid var(--border-subtle); display:flex; gap:10px; justify-content:flex-end; background:var(--ivory-mid);">
                    <button type="button" class="btn-modal-cancel" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn-modal-confirm"><i class="bi bi-check-circle-fill"></i> Confirm Acceptance</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- DECLINE MODAL -->
<div class="modal fade" id="declineModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header-styled crimson">
                <div class="modal-title-styled"><i class="bi bi-x-circle-fill" style="color:var(--crimson);"></i> Decline Request</div>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="POST" action="{% url 'reject_blood_request' blood_request.id %}">
                {% csrf_token %}
                <div style="padding:24px;">
                    <p style="font-size:13.5px; color:var(--ink-mid); margin-bottom:14px;">Please let us know why (optional):</p>
                    <label class="form-label-styled">Reason for Declining</label>
                    <div class="select-wrap" style="margin-bottom:10px;">
                        <select class="form-control-styled" name="reason">
                            <option value="">Select a reason...</option>
                            <option value="Too far">Location too far</option>
                            <option value="Not available">Not available at this time</option>
                            <option value="Health reasons">Health reasons</option>
                            <option value="Recently donated">Recently donated blood</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <textarea class="form-control-styled" name="additional_notes" rows="2" placeholder="Additional details (optional)..."></textarea>
                    <div class="notice-bar info" style="margin-top:14px; margin-bottom:0;">
                        <i class="bi bi-info-circle-fill"></i>
                        <div style="font-size:12.5px;">The next eligible donor will be automatically notified.</div>
                    </div>
                </div>
                <div style="padding:16px 24px; border-top:1px solid var(--border-subtle); display:flex; gap:10px; justify-content:flex-end; background:var(--ivory-mid);">
                    <button type="button" class="btn-modal-cancel" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn-modal-danger"><i class="bi bi-x-circle-fill"></i> Confirm Decline</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}